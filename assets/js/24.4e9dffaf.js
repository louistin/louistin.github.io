(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{355:function(e,i,l){"use strict";l.r(i);var s=l(8),a=Object(s.a)({},(function(){var e=this,i=e.$createElement,l=e._self._c||i;return l("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[l("h1",{attrs:{id:"ffmpeg-x265-windows-编译"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#ffmpeg-x265-windows-编译"}},[e._v("#")]),e._v(" FFMPEG x265 Windows 编译")]),e._v(" "),l("blockquote",[l("p",[e._v("OS: Windows 10 x64"),l("br"),e._v("\nVS: Visual Studio 2015 Enterprise")])]),e._v(" "),l("h2",{attrs:{id:"_1-下载-ffmpeg-源码"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载-ffmpeg-源码"}},[e._v("#")]),e._v(" 1. 下载 ffmpeg 源码")]),e._v(" "),l("ul",[l("li",[l("code",[e._v("http://ffmpeg.org/download.html")])])]),e._v(" "),l("h2",{attrs:{id:"_2-下载安装-mingw"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#_2-下载安装-mingw"}},[e._v("#")]),e._v(" 2. 下载安装 MinGW")]),e._v(" "),l("ul",[l("li",[l("code",[e._v("https://sourceforge.net/projects/mingw/files/")])]),e._v(" "),l("li",[e._v("默认安装路径, 勾选选项\n"),l("ul",[l("li",[e._v("mingw-developer-toolkit")]),e._v(" "),l("li",[e._v("mingw32-base")]),e._v(" "),l("li",[e._v("mingw32-gcc-g++")]),e._v(" "),l("li",[e._v("msys-base")])])])]),e._v(" "),l("h2",{attrs:{id:"_3-下载-yasm-pkg-config-exe-libglib-2-0-0-dll"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#_3-下载-yasm-pkg-config-exe-libglib-2-0-0-dll"}},[e._v("#")]),e._v(" 3. 下载 yasm pkg-config.exe libglib-2.0-0.dll")]),e._v(" "),l("ul",[l("li",[l("code",[e._v("http://yasm.tortall.net/Download.html")])]),e._v(" "),l("li",[e._v("下载 "),l("code",[e._v("for general use on 32-bit Windows")]),e._v(" 和 "),l("code",[e._v("for general use on 64-bit Windows")])]),e._v(" "),l("li",[e._v("将下载文件拷贝到 "),l("code",[e._v("C:\\MinGW\\msys\\1.0\\bin")])]),e._v(" "),l("li",[e._v("改名为 "),l("code",[e._v("yasm.exe")]),e._v(" "),l("ul",[l("li",[e._v("编译32位时, 修改 "),l("code",[e._v("yasm-1.3.0-win32.exe")])]),e._v(" "),l("li",[e._v("编译64位时, 修改 "),l("code",[e._v("yasm-1.3.0-win64.exe")])])])]),e._v(" "),l("li",[e._v("将 pkg-config.exe libglib-2.0-0.dll 放到 "),l("code",[e._v("X:\\Louis\\Documents\\Local\\MinGW\\bin")]),e._v(" 目录中")])]),e._v(" "),l("h2",{attrs:{id:"_4-配置编译"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#_4-配置编译"}},[e._v("#")]),e._v(" 4. 配置编译")]),e._v(" "),l("ul",[l("li",[e._v("配置 "),l("code",[e._v("配置C:\\MinGW\\msys\\1.0\\msys.bat")]),e._v(", 编辑器打开后, 在 "),l("code",[e._v("@echo off")]),e._v("之后, 加上一行\n"),l("ul",[l("li",[e._v("32位, "),l("code",[e._v('call "C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\bin\\vcvars32.bat"')])]),e._v(" "),l("li",[e._v("64位, "),l("code",[e._v('call "C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\bin\\amd64\\vcvars64.bat"')])])])]),e._v(" "),l("li",[e._v("重命名 "),l("code",[e._v("C:\\MinGW\\msys\\1.0\\bin\\link.exe")]),e._v(", 防止与VC冲突, 名字可以自己取")]),e._v(" "),l("li",[e._v("双击打开 "),l("code",[e._v("C:\\MinGW\\msys\\1.0\\msys.bat")])]),e._v(" "),l("li",[e._v("将第一步中的ffmpeg 源码解压到 "),l("code",[e._v("C:\\MinGW\\msys\\1.0\\home\\Louis")]),e._v(" (Louis换成你的用户名)")]),e._v(" "),l("li",[e._v("在CMD中定位到 "),l("code",[e._v("C:\\MinGW\\msys\\1.0\\home\\Louis\\ffmpeg")])]),e._v(" "),l("li",[e._v("配置\n"),l("ul",[l("li",[e._v("32位, "),l("code",[e._v("./configure --enable-shared --disable-static –-enable-gpl –-enable-version3 --prefix=./build/x86 --enable-debug --toolchain=msvc")])]),e._v(" "),l("li",[e._v("64位, "),l("code",[e._v("./configure --enable-shared --disable-static –-enable-gpl –-enable-version3 --prefix=./build/x64 --enable-debug --toolchain=msvc")])])])]),e._v(" "),l("li",[e._v("打开"),l("code",[e._v("config.h")]),e._v(" 将含有中文的字符串修改为字母字符串(字母的就行)")]),e._v(" "),l("li",[e._v("make all && make install (时间比较久)")]),e._v(" "),l("li",[e._v("检查 "),l("code",[e._v("C:\\MinGW\\msys\\1.0\\home\\Louis\\ffmpeg\\build")]),e._v("中, 生成 include lib 等文件夹")])]),e._v(" "),l("h2",{attrs:{id:"_5-265-编译"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#_5-265-编译"}},[e._v("#")]),e._v(" 5. 265 编译")]),e._v(" "),l("ul",[l("li",[l("p",[e._v("准备工作")]),e._v(" "),l("ul",[l("li",[e._v("CMake 下载安装 "),l("code",[e._v("https://github.com/Kitware/CMake/releases/download/v3.17.0/cmake-3.17.0-win64-x64.msi")])]),e._v(" "),l("li",[e._v("nasm 下载安装 "),l("code",[e._v("https://www.nasm.us/pub/nasm/releasebuilds/2.14.02/win64/nasm-2.14.02-installer-x64.exe")])]),e._v(" "),l("li",[e._v("x265 源码下载 "),l("code",[e._v("http://ftp.videolan.org/pub/videolan/x265/x265_3.2.tar.gz")])])])]),e._v(" "),l("li",[l("p",[e._v("x265 编译")]),e._v(" "),l("ul",[l("li",[e._v("CMake 安装后, 打开CMake-gui 工具")]),e._v(" "),l("li",[e._v("Source 配置 "),l("code",[e._v("X:/Louis/Documents/Local/MinGW/msys/1.0/home/Louis/x265_3.2/source")])]),e._v(" "),l("li",[e._v("Build 配置 "),l("code",[e._v("X:/Louis/Documents/Local/MinGW/msys/1.0/home/Louis/x265_3.2/build")])]),e._v(" "),l("li",[e._v("Configure -> 选择 VS2015 / x64")]),e._v(" "),l("li",[e._v("NASM_EXECUTABLE 配置nasm 安装路径")]),e._v(" "),l("li",[e._v("Generate")]),e._v(" "),l("li",[e._v("Open Project")]),e._v(" "),l("li",[e._v("在打开的VS 中 ALL_BUILD")]),e._v(" "),l("li",[e._v("编译生成的可执行文件和动态库位于 "),l("code",[e._v("x265\\build\\Debug")])])])])]),e._v(" "),l("h2",{attrs:{id:"_5-ffmpeg-编译支持-x265"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#_5-ffmpeg-编译支持-x265"}},[e._v("#")]),e._v(" 5. FFMPEG 编译支持 x265")]),e._v(" "),l("ul",[l("li",[l("p",[e._v("配置 (X:\\Louis\\Documents\\Local\\MinGW\\msys\\1.0)")]),e._v(" "),l("ul",[l("li",[e._v("拷贝x265编译结果中的libx265.lib和x265-static.lib至/local/lib文件夹下。并复制libx265.lib为x265.lib")]),e._v(" "),l("li",[e._v("拷贝x265.h和x265_config.h至/local/include文件夹下")]),e._v(" "),l("li",[e._v("拷贝libx265.dll和x265.exe至/local/bin文件夹下")]),e._v(" "),l("li",[e._v("/local/lib/pkgconfig 创建 x265.pc"),l("div",{staticClass:"language- line-numbers-mode"},[l("pre",{pre:!0,attrs:{class:"language-text"}},[l("code",[e._v("prefix=/local/\nexec_prefix=${prefix}\nlibdir=${exec_prefix}/lib\nincludedir=${prefix}/include\n\nName: x265\nDescription: H.265/HEVC video encoder\nVersion: 2.8\nLibs: -L${libdir} -lx265\nLibs.private: -lstdc++ -lm -lrt -ldl -lpthread\nCflags: -I${includedir}\n")])]),e._v(" "),l("div",{staticClass:"line-numbers-wrapper"},[l("span",{staticClass:"line-number"},[e._v("1")]),l("br"),l("span",{staticClass:"line-number"},[e._v("2")]),l("br"),l("span",{staticClass:"line-number"},[e._v("3")]),l("br"),l("span",{staticClass:"line-number"},[e._v("4")]),l("br"),l("span",{staticClass:"line-number"},[e._v("5")]),l("br"),l("span",{staticClass:"line-number"},[e._v("6")]),l("br"),l("span",{staticClass:"line-number"},[e._v("7")]),l("br"),l("span",{staticClass:"line-number"},[e._v("8")]),l("br"),l("span",{staticClass:"line-number"},[e._v("9")]),l("br"),l("span",{staticClass:"line-number"},[e._v("10")]),l("br"),l("span",{staticClass:"line-number"},[e._v("11")]),l("br")])])])])]),e._v(" "),l("li",[l("p",[e._v("编译安装")]),e._v(" "),l("ul",[l("li",[e._v("export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/local/lib/pkgconfig")]),e._v(" "),l("li",[e._v("执行pkg-config --list-all确保已经正确查找到x265")]),e._v(" "),l("li",[l("code",[e._v("./configure --enable-shared --disable-static –-enable-gpl –-enable-version3 --enable-libx265 --prefix=./build/x64 --enable-debug --toolchain=msvc")])]),e._v(" "),l("li",[e._v("make -j4 && make install")])])]),e._v(" "),l("li",[l("p",[e._v("Tips")]),e._v(" "),l("ul",[l("li",[e._v("动态库静态库必须分开编译")]),e._v(" "),l("li",[e._v("x265 更高版本没测试成功")]),e._v(" "),l("li",[e._v("./configure 失败可以去 ffbuild/config.log 中查看")])])])]),e._v(" "),l("h2",{attrs:{id:"参考链接"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[e._v("#")]),e._v(" 参考链接")]),e._v(" "),l("div",{staticClass:"language- line-numbers-mode"},[l("pre",{pre:!0,attrs:{class:"language-text"}},[l("code",[e._v("https://blog.csdn.net/yinchao163/article/details/82625544\nhttps://blog.csdn.net/smallhujiu/article/details/80747568\nhttps://blog.csdn.net/smallhujiu/article/details/80753765\nhttps://www.nasm.us/pub/nasm/releasebuilds/2.14.02/win64/\nhttps://kelvin.mbioq.com/install-pkgconfig-mingwmsys.html\n")])]),e._v(" "),l("div",{staticClass:"line-numbers-wrapper"},[l("span",{staticClass:"line-number"},[e._v("1")]),l("br"),l("span",{staticClass:"line-number"},[e._v("2")]),l("br"),l("span",{staticClass:"line-number"},[e._v("3")]),l("br"),l("span",{staticClass:"line-number"},[e._v("4")]),l("br"),l("span",{staticClass:"line-number"},[e._v("5")]),l("br")])])])}),[],!1,null,null,null);i.default=a.exports}}]);