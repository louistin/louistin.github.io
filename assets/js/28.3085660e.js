(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{359:function(s,a,n){"use strict";n.r(a);var t=n(8),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"dns-协议"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dns-协议"}},[s._v("#")]),s._v(" DNS 协议")]),s._v(" "),n("blockquote",[n("p",[s._v("Domain Name System")])]),s._v(" "),n("h2",{attrs:{id:"dns-协议基础"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dns-协议基础"}},[s._v("#")]),s._v(" DNS 协议基础")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("域名空间")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("使用层次的地址结构\n顶级域名"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(".com .cn .edu "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 二级域名 -"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 三级域名\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("域名资源记录")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("Domain_name Time_to_live Class Type Value\nDomain_name "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 指出此条记录适用于那个域名\nTime_to_live "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 记录生存周期\nClass "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 一般为 IN\nType "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 记录的类型\nValue "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 记录的值\n    A "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IPv4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    AAA "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IPv6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    CNAME "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("当前域名别名"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    NS "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("该域名所在域的权威域名服务器"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    MX "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("接受特定域名电子邮件的服务器域名"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("域名服务器")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("将域名的名字空间划分为不重叠的区域"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DNS Zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", 然后将每个区域与多个域名服务器"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("其中一个是\n  master, 其他为 slave"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("关联起来, 这些域名服务器为该地区的权威域名服务器.\n\n权威域名服务器保存域名资源记录:\n    该区域内所有域名的域名资源记录\n    父区域和子区域的域名服务器对应的域名资源记录"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NS 记录"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n根域名服务器保存所有顶级区域的权威域名服务器记录, 通过其可以找到所有顶级区域的权威域名服务\n  器, 然后可以往下一级一级查找.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("域名解析")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("Client -"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 本地域名服务器"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.8")]),s._v(".8.8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" - 查到了 -"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 返回记录\n                - 没查到 -"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 从根域名服务器开始向下搜索, 逐级查找\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])])])]),s._v(" "),n("h2",{attrs:{id:"缓存机制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#缓存机制"}},[s._v("#")]),s._v(" 缓存机制")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("本机缓存\n域名服务器缓存\nTime_to_live 字段决定缓存有效期\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h2",{attrs:{id:"其他"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[s._v("#")]),s._v(" 其他")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("域名解析相关指令")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dig baidu.com -t A +short")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("39.156")]),s._v(".69.79\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("220.181")]),s._v(".38.148\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  dig -x 119.3.85.251 +short")]),s._v("\necs-119-3-85-251.compute.hwclouds-dns.com.\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解析路径查询")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("dig")]),s._v(" baidu.com +trace @8.8.8.8\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("DNS 劫持")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 域名服务器自己搞怪, 解析错误")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  nslookup google.com")]),s._v("\nServer:\t\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("183.60")]),s._v(".83.19\nAddress:\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("183.60")]),s._v(".83.19"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#53")]),s._v("\n\nNon-authoritative answer:\nName:\tgoogle.com\nAddress: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("46.82")]),s._v(".174.69\nName:\tgoogle.com\nAddress: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2404")]),s._v(":6800:4012::200e\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 验证")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# whois 46.82.174.69")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定解析 DNS")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nslookup facebook.com 8.8.8.8")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("DNS 欺骗")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("Client 请求 DNS Server 后, 收到伪造的欺骗响应数据\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])])])])}),[],!1,null,null,null);a.default=e.exports}}]);